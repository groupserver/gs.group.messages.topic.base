<html metal:use-macro="context/@@groupserver_layout/page">
  <head>
    <title metal:fill-slot="title">
      <span tal:define="retval view/update;"
        tal:replace="view/topicName">
        Standard Template for a Single Post
      </span>:
      <span tal:replace="view/groupInfo/name"/>:
      <span tal:replace="view/siteInfo/name"/>
    </title>
    <tal:block metal:fill-slot="metadata" 
      tal:define="topicName view/topicName">
      <link tal:condition="view/previousTopic/topicId" 
        rel="prev" title="Previous topic" href="wibble"
        tal:attributes="href view/previousTopic/topicId; 
        title string:Later topic: ${view/previousTopic/subject}" />
      <link tal:condition="view/nextTopic/topicId" 
        rel="next" title="earlier topic" href="wibble"
        tal:attributes="href view/nextTopic/topicId; 
        title string:Earlier topic: ${view/nextTopic/subject};" />
      <link rel="up" title="All topics" href="../topics.html"
        tal:attributes="title string:Topics in ${view/groupInfo/name};"/>
      <link rel="bookmark" title="Group Homepage" href="#"
        tal:attributes="title string:${view/groupInfo/name} Homepage;
        href view/groupInfo/url" />
      <link rel="home" 
        tal:attributes="title string:${view/siteInfo/name} Homepage;
        href view/siteInfo/url" />
      <link rel="help" 
        tal:attributes="title string:${view/siteInfo/name} Help;
        href string:${view/siteInfo/url}/help" />
      <meta name="description"
            tal:attributes="content python:view.topic[0]['summary']" />
    </tal:block>
  </head>
  
  <body>
    <tal:block content="structure provider:groupserver.FormStatusMessage"
      define="errors view/errors; status view/status; widgets view/widgets"
      metal:fill-slot="messages">&#160;</tal:block>
    <div class="hfeed" metal:fill-slot="body"
      tal:define="topicList view/topic"
      tal:condition="topicList">
      <form tal:condition="view/userIsAdmin"
        class="adminTasks" id="toggleStickyTopic"
        enctype="multipart/form-data"  method="post" action="."
        tal:attributes="action request/URL">
        <tal:block define="widgets python:[view.widgets['sticky']]">
          <tal:block replace="structure provider:groupserver.FormWidgets"/>
        </tal:block>
        <div class="buttons" tal:condition="view/availableActions">
          <div class="formelementbutton">
            <tal:block
              replace="structure python:view.availableActions()[1].render()">
              Button
            </tal:block>
          </div>
        </div>
      </form>
      
      <h1><cite tal:content="view/topicName">This Topic</cite></h1>
      <tal:block replace="structure provider:groupserver.TopicPage">
        The bulk of the page
      </tal:block>
    </div><!--hfeed-->

    <tal:block metal:fill-slot="javascript">
      <script type="text/javascript"
        src="/++resource++hide-post-20110415.js">&#160;</script>
      <script type="text/javascript"
        src="/++resource++multiple_file_upload/jquery.form.js">&#160;</script>
      <script type="text/javascript"
        src="/++resource++multiple_file_upload/jquery.MetaData.js">&#160;</script>
      <script type="text/javascript"
        src="/++resource++multiple_file_upload/jquery.MultiFile.js">&#160;</script>
      <script type="text/javascript"
        src="/++resource++multiple_file_upload/jquery.blockUI.js">&#160;</script>
      <script type="text/javascript"
        src="/++resource++gsfileupload-20090622.js">&#160;</script>
      <script type="text/javascript"
        src="/++resource++popup_help-20071218.js">&#160;</script>
      <script type="text/javascript"
        src="/++resource++sharebox-20100721.js">&#160;</script>
      <script type="text/javascript">
        jQuery.noConflict();
        jQuery(document).ready( function () {
          GSPopupFormHelp.init('#add-to-topic');
          GSFileUpload.init();
        });
      </script>
    </tal:block>
  </body>
</html>

